{% extends "base.html" %}
{% block content %}
<div style='padding: 1% 1%; width: 100vw; height: 93vh'>
        <div style='height: 100%; float: left; overflow: auto; width: calc(98% - 850px); padding: 0 1%;'>
            <button onclick="showDivCreate()" class='expand-btn' style="font-size: 8pt">Create Ticket</button>
            <div id='expandCreate' class='expand-content'>
                <form id='exp1' action="" method="post">
                    <div>
                        Subject: {{ ticketInsertForm.subject(class_='submit-frm') }} Priority:{{ ticketInsertForm.priority }} Status:{{ ticketInsertForm.status }} Category:{{ ticketInsertForm.category }}<br>
                        Body: {{ ticketInsertForm.body(class_="fresh-frm") }}
                    </div>
                    <div style='margin: 10px'>
                        {{ ticketInsertForm.submitInsertTicket }}
                    </div>
                </form>
            </div>
            <table>
                <tr><th style='width: 5%'>ID</th><th style='width: 45%'>Subject</th><th style='width: 5%'>Status</th><th style='width: 5%'>Priority</th><th style='width: 5%'>Updated At</th><th style='width: 7%'>Created By</th><th style='width: 7%'>Assigned</th><th style='width: 7%'>Due By</th><th style='width: 7%'>Category</th></tr>
                {% for tick in tickets %}
                {% if tick.id == id %}
                <tr><td class='selected'><a href="/ticket/all/{{ tick.id }}">{{ tick.id }}</a></td><td class='selected'><a href="/ticket/all/{{ tick.id }}">{{ tick.subject }}</a></td class='selected'><td class='selected'>{{ tick.status.name }}</td><td class='selected'>{{ tick.priority.name }}</td><td class='selected'>{{ tick.updated_at[5:-3] }}</td><td class='selected'>{{ tick.created_by }}</td><td class='selected'>{{ tick.assigned }}</td><td class='selected'>{{ tick.due_by }}</td><td class='selected'>{{ tick.category }}</td></tr>
                {% else %}
                <tr><td><a href="/ticket/all/{{ tick.id }}">{{ tick.id }}</a></td><td><a href="/ticket/all/{{ tick.id }}">{{ tick.subject }}</a></td><td>{{ tick.status.name }}</td><td>{{ tick.priority.name }}</td><td>{{ tick.updated_at[5:-3] }}</td><td>{{ tick.created_by }}</td><td>{{ tick.assigned }}</td><td>{{ tick.due_by }}</td><td>{{ tick.category }}</td></tr>
                {% endif %}
                {% endfor %}
            </table>
        </div>
        <div style='height: 100%; width: 850px; overflow: auto; padding: 0 1%; float: left;'>
        <div id='dropOpen' ondrop="drop_move(event)" ondragover="allowDrop(event)" class='col-4'>
            <h3>Open</h3>
            {% for ticket in projects %}
            {% if ticket.status.value == 1 %}
                <p id="drag{{ ticket.id }}" draggable="true" ondragstart="drag(event)" class='rcorners {{ ticket.priority.name }}'><a href="/board/{{ ticket.id }}">{{ ticket.subject }}</a></p>
                {% endif %}
            {% endfor %}
        </div>
        <div id='dropWorking' ondrop="drop_move(event)" ondragover="allowDrop(event)" class='col-4'>
            <h3>Working</h3>
            {% for ticket in projects %}
            {% if ticket.status.value == 2 %}
                <p id="drag{{ ticket.id }}" draggable="true" ondragstart="drag(event)" class='rcorners {{ ticket.priority.name }}'><a href="/board/{{ ticket.id }}">{{ ticket.subject }}</a></p>
                {% endif %}
            {% endfor %}
        </div>
        <div id='dropWaiting' ondrop="drop_move(event)" ondragover="allowDrop(event)" class='col-4'>
            <h3>Waiting</h3>
            {% for ticket in projects %}
            {% if ticket.status.value == 3 %}
                <p id="drag{{ ticket.id }}" draggable="true" ondragstart="drag(event)" class='rcorners {{ ticket.priority.name }}'><a href="/board/{{ ticket.id }}">{{ ticket.subject }}</a></p>
                {% endif %}
            {% endfor %} 
        </div>
        <div id='dropClosed' ondrop="drop_move(event)" ondragover="allowDrop(event)" class='col-4'>
            <h3>Closed</h3>
            {% for ticket in projects %}
                {% if ticket.status.value == 4 %}{% if loop.index < 5 %}
                <p id="drag{{ ticket.id }}" draggable="true" ondragstart="drag(event)" class='rcorners {{ ticket.priority.name }}'><a href="/board/{{ ticket.id }}">{{ ticket.subject }}</a></p>
                {% endif %}{% endif %}
            {% endfor %}
        </div>
    </div>
</div>

{% endblock %}